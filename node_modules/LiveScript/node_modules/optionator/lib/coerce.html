<!DOCTYPE html><html lang="en"><head><title>node_modules/LiveScript/node_modules/optionator/lib/coerce</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../../../../"><meta name="groc-document-path" content="node_modules/LiveScript/node_modules/optionator/lib/coerce"><meta name="groc-project-path" content="node_modules/LiveScript/node_modules/optionator/lib/coerce.js"><meta name="groc-github-url" content="https://github.com/DimensionSoftware/instant-skeleton"><link rel="stylesheet" type="text/css" media="all" href="../../../../../assets/style.css"><script type="text/javascript" src="../../../../../assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/DimensionSoftware/instant-skeleton/blob/master/node_modules/LiveScript/node_modules/optionator/lib/coerce.js">node_modules/LiveScript/node_modules/optionator/lib/coerce.js</a></div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><p>Generated by LiveScript 1.2.0</p></div></div><div class="code"><div class="wrapper">(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
  <span class="hljs-keyword">var</span> ref$, id, reject, parsedTypeCheck, types, tokenRegex, toString$ = {}.toString;
  ref$ = <span class="hljs-built_in">require</span>(<span class="hljs-string">'prelude-ls'</span>), id = ref$.id, reject = ref$.reject;
  parsedTypeCheck = <span class="hljs-built_in">require</span>(<span class="hljs-string">'type-check'</span>).parsedTypeCheck;
  types = {
    <span class="hljs-string">'*'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(it)</span>{</span>
      <span class="hljs-keyword">switch</span> (toString$.call(it).slice(<span class="hljs-number">8</span>, -<span class="hljs-number">1</span>)) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'Array'</span>:
        <span class="hljs-keyword">return</span> coerceType(it, {
          type: <span class="hljs-string">'Array'</span>
        });
      <span class="hljs-keyword">case</span> <span class="hljs-string">'Object'</span>:
        <span class="hljs-keyword">return</span> coerceType(it, {
          type: <span class="hljs-string">'Object'</span>
        });
      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">return</span> {
          type: <span class="hljs-string">'Just'</span>,
          value: coerceTypes(it, [
            {
              type: <span class="hljs-string">'Undefined'</span>
            }, {
              type: <span class="hljs-string">'Null'</span>
            }, {
              type: <span class="hljs-string">'Boolean'</span>
            }, {
              type: <span class="hljs-string">'Number'</span>
            }, {
              type: <span class="hljs-string">'Date'</span>
            }, {
              type: <span class="hljs-string">'RegExp'</span>
            }, {
              type: <span class="hljs-string">'Array'</span>
            }, {
              type: <span class="hljs-string">'Object'</span>
            }, {
              type: <span class="hljs-string">'String'</span>
            }
          ], {
            explicit: <span class="hljs-literal">true</span>
          })
        };
      }
    },
    Undefined: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(it)</span>{</span>
      <span class="hljs-keyword">if</span> (it === <span class="hljs-string">'undefined'</span>) {
        <span class="hljs-keyword">return</span> {
          type: <span class="hljs-string">'Just'</span>,
          value: <span class="hljs-keyword">void</span> <span class="hljs-number">8</span>
        };
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> {
          type: <span class="hljs-string">'Nothing'</span>
        };
      }
    },
    Null: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(it)</span>{</span>
      <span class="hljs-keyword">if</span> (it === <span class="hljs-string">'null'</span>) {
        <span class="hljs-keyword">return</span> {
          type: <span class="hljs-string">'Just'</span>,
          value: <span class="hljs-literal">null</span>
        };
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> {
          type: <span class="hljs-string">'Nothing'</span>
        };
      }
    },
    <span class="hljs-built_in">Boolean</span>: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(it)</span>{</span>
      <span class="hljs-keyword">if</span> (it === <span class="hljs-string">'true'</span>) {
        <span class="hljs-keyword">return</span> {
          type: <span class="hljs-string">'Just'</span>,
          value: <span class="hljs-literal">true</span>
        };
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (it === <span class="hljs-string">'false'</span>) {
        <span class="hljs-keyword">return</span> {
          type: <span class="hljs-string">'Just'</span>,
          value: <span class="hljs-literal">false</span>
        };
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> {
          type: <span class="hljs-string">'Nothing'</span>
        };
      }
    },
    <span class="hljs-built_in">Number</span>: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(it)</span>{</span>
      <span class="hljs-keyword">return</span> {
        type: <span class="hljs-string">'Just'</span>,
        value: +it
      };
    },
    Int: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(it)</span>{</span>
      <span class="hljs-keyword">return</span> {
        type: <span class="hljs-string">'Just'</span>,
        value: <span class="hljs-built_in">parseInt</span>(it)
      };
    },
    Float: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(it)</span>{</span>
      <span class="hljs-keyword">return</span> {
        type: <span class="hljs-string">'Just'</span>,
        value: <span class="hljs-built_in">parseFloat</span>(it)
      };
    },
    <span class="hljs-built_in">Date</span>: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value, options)</span>{</span>
      <span class="hljs-keyword">var</span> that;
      <span class="hljs-keyword">if</span> (that = <span class="hljs-regexp">/^\#(.*)\#$/</span>.exec(value)) {
        <span class="hljs-keyword">return</span> {
          type: <span class="hljs-string">'Just'</span>,
          value: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(+that[<span class="hljs-number">1</span>] || that[<span class="hljs-number">1</span>])
        };
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (options.explicit) {
        <span class="hljs-keyword">return</span> {
          type: <span class="hljs-string">'Nothing'</span>
        };
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> {
          type: <span class="hljs-string">'Just'</span>,
          value: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(+value || value)
        };
      }
    },
    <span class="hljs-built_in">RegExp</span>: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value, options)</span>{</span>
      <span class="hljs-keyword">var</span> that;
      <span class="hljs-keyword">if</span> (that = <span class="hljs-regexp">/^\/(.*)\/([gimy]*)$/</span>.exec(value)) {
        <span class="hljs-keyword">return</span> {
          type: <span class="hljs-string">'Just'</span>,
          value: <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(that[<span class="hljs-number">1</span>], that[<span class="hljs-number">2</span>])
        };
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (options.explicit) {
        <span class="hljs-keyword">return</span> {
          type: <span class="hljs-string">'Nothing'</span>
        };
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> {
          type: <span class="hljs-string">'Just'</span>,
          value: <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(value)
        };
      }
    },
    <span class="hljs-built_in">Array</span>: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(it)</span>{</span>
      <span class="hljs-keyword">return</span> coerceArray(it, {
        of: [{
          type: <span class="hljs-string">'*'</span>
        }]
      });
    },
    <span class="hljs-built_in">Object</span>: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(it)</span>{</span>
      <span class="hljs-keyword">return</span> coerceFields(it, {
        of: {}
      });
    },
    <span class="hljs-built_in">String</span>: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(it)</span>{</span>
      <span class="hljs-keyword">var</span> that;
      <span class="hljs-keyword">if</span> (that = it.match(<span class="hljs-regexp">/^'(.*)'$/</span>)) {
        <span class="hljs-keyword">return</span> {
          type: <span class="hljs-string">'Just'</span>,
          value: that[<span class="hljs-number">1</span>]
        };
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (that = it.match(<span class="hljs-regexp">/^"(.*)"$/</span>)) {
        <span class="hljs-keyword">return</span> {
          type: <span class="hljs-string">'Just'</span>,
          value: that[<span class="hljs-number">1</span>]
        };
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> {
          type: <span class="hljs-string">'Just'</span>,
          value: it
        };
      }
    }
  };
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">coerceArray</span><span class="hljs-params">(node, type)</span>{</span>
    <span class="hljs-keyword">var</span> typeOf, element;
    <span class="hljs-keyword">if</span> (toString$.call(node).slice(<span class="hljs-number">8</span>, -<span class="hljs-number">1</span>) !== <span class="hljs-string">'Array'</span>) {
      <span class="hljs-keyword">return</span> {
        type: <span class="hljs-string">'Nothing'</span>
      };
    }
    typeOf = type.of;
    <span class="hljs-keyword">return</span> {
      type: <span class="hljs-string">'Just'</span>,
      value: (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
        <span class="hljs-keyword">var</span> i$, ref$, len$, results$ = [];
        <span class="hljs-keyword">for</span> (i$ = <span class="hljs-number">0</span>, len$ = (ref$ = node).length; i$ &lt; len$; ++i$) {
          element = ref$[i$];
          results$.push(coerceTypes(element, typeOf));
        }
        <span class="hljs-keyword">return</span> results$;
      }())
    };
  }
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">coerceTuple</span><span class="hljs-params">(node, type)</span>{</span>
    <span class="hljs-keyword">var</span> i, types;
    <span class="hljs-keyword">if</span> (toString$.call(node).slice(<span class="hljs-number">8</span>, -<span class="hljs-number">1</span>) !== <span class="hljs-string">'Array'</span>) {
      <span class="hljs-keyword">return</span> {
        type: <span class="hljs-string">'Nothing'</span>
      };
    }
    <span class="hljs-keyword">return</span> {
      type: <span class="hljs-string">'Just'</span>,
      value: (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
        <span class="hljs-keyword">var</span> i$, ref$, len$, results$ = [];
        <span class="hljs-keyword">for</span> (i$ = <span class="hljs-number">0</span>, len$ = (ref$ = type.of).length; i$ &lt; len$; ++i$) {
          i = i$;
          types = ref$[i$];
          results$.push(coerceTypes(node[i], types));
        }
        <span class="hljs-keyword">return</span> results$;
      }())
    };
  }
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">coerceFields</span><span class="hljs-params">(node, type)</span>{</span>
    <span class="hljs-keyword">var</span> typeOf, key, value;
    <span class="hljs-keyword">if</span> (toString$.call(node).slice(<span class="hljs-number">8</span>, -<span class="hljs-number">1</span>) !== <span class="hljs-string">'Object'</span>) {
      <span class="hljs-keyword">return</span> {
        type: <span class="hljs-string">'Nothing'</span>
      };
    }
    typeOf = type.of;
    <span class="hljs-keyword">return</span> {
      type: <span class="hljs-string">'Just'</span>,
      value: (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
        <span class="hljs-keyword">var</span> ref$, results$ = {};
        <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> ref$ = node) {
          value = ref$[key];
          results$[key] = coerceTypes(value, typeOf[key] || [{
            type: <span class="hljs-string">'*'</span>
          }]);
        }
        <span class="hljs-keyword">return</span> results$;
      }())
    };
  }
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">coerceType</span><span class="hljs-params">(node, typeObj, options)</span>{</span>
    <span class="hljs-keyword">var</span> type, structure, coerceFunc;
    type = typeObj.type, structure = typeObj.structure;
    <span class="hljs-keyword">if</span> (type) {
      coerceFunc = types[type];
      <span class="hljs-keyword">return</span> coerceFunc(node, options);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">switch</span> (structure) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'array'</span>:
        <span class="hljs-keyword">return</span> coerceArray(node, typeObj);
      <span class="hljs-keyword">case</span> <span class="hljs-string">'tuple'</span>:
        <span class="hljs-keyword">return</span> coerceTuple(node, typeObj);
      <span class="hljs-keyword">case</span> <span class="hljs-string">'fields'</span>:
        <span class="hljs-keyword">return</span> coerceFields(node, typeObj);
      }
    }
  }
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">coerceTypes</span><span class="hljs-params">(node, types, options)</span>{</span>
    <span class="hljs-keyword">var</span> i$, len$, type, ref$, valueType, value;
    options == <span class="hljs-literal">null</span> &amp;&amp; (options = {});
    <span class="hljs-keyword">for</span> (i$ = <span class="hljs-number">0</span>, len$ = types.length; i$ &lt; len$; ++i$) {
      type = types[i$];
      ref$ = coerceType(node, type, options), valueType = ref$.type, value = ref$.value;
      <span class="hljs-keyword">if</span> (valueType === <span class="hljs-string">'Nothing'</span>) {
        <span class="hljs-keyword">continue</span>;
      }
      <span class="hljs-keyword">if</span> (parsedTypeCheck([type], value)) {
        <span class="hljs-keyword">return</span> value;
      }
    }
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Value '"</span> + node + <span class="hljs-string">"' does not type check against "</span> + <span class="hljs-built_in">JSON</span>.stringify(types) + <span class="hljs-string">"."</span>);
  }
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">consumeOp</span><span class="hljs-params">(tokens, op)</span>{</span>
    <span class="hljs-keyword">if</span> (tokens[<span class="hljs-number">0</span>] === op) {
      <span class="hljs-keyword">return</span> tokens.shift();
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Expected '"</span> + op + <span class="hljs-string">"', but got "</span> + tokens[<span class="hljs-number">0</span>] + <span class="hljs-string">" instead."</span>);
    }
  }
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">maybeConsumeOp</span><span class="hljs-params">(tokens, op)</span>{</span>
    <span class="hljs-keyword">if</span> (tokens[<span class="hljs-number">0</span>] === op) {
      <span class="hljs-keyword">return</span> tokens.shift();
    }
  }
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">consumeList</span><span class="hljs-params">(tokens, delimiters, hasDelimiters)</span>{</span>
    <span class="hljs-keyword">var</span> result;
    <span class="hljs-keyword">if</span> (hasDelimiters) {
      consumeOp(tokens, delimiters[<span class="hljs-number">0</span>]);
    }
    result = [];
    <span class="hljs-keyword">while</span> (tokens.length &amp;&amp; tokens[<span class="hljs-number">0</span>] !== delimiters[<span class="hljs-number">1</span>]) {
      result.push(consumeElement(tokens));
      maybeConsumeOp(tokens, <span class="hljs-string">','</span>);
    }
    <span class="hljs-keyword">if</span> (hasDelimiters) {
      consumeOp(tokens, delimiters[<span class="hljs-number">1</span>]);
    }
    <span class="hljs-keyword">return</span> result;
  }
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">consumeArray</span><span class="hljs-params">(tokens, hasDelimiters)</span>{</span>
    <span class="hljs-keyword">return</span> consumeList(tokens, [<span class="hljs-string">'['</span>, <span class="hljs-string">']'</span>], hasDelimiters);
  }
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">consumeTuple</span><span class="hljs-params">(tokens, hasDelimiters)</span>{</span>
    <span class="hljs-keyword">return</span> consumeList(tokens, [<span class="hljs-string">'('</span>, <span class="hljs-string">')'</span>], hasDelimiters);
  }
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">consumeFields</span><span class="hljs-params">(tokens, hasDelimiters)</span>{</span>
    <span class="hljs-keyword">var</span> result, key;
    <span class="hljs-keyword">if</span> (hasDelimiters) {
      consumeOp(tokens, <span class="hljs-string">'{'</span>);
    }
    result = {};
    <span class="hljs-keyword">while</span> (tokens.length &amp;&amp; (!hasDelimiters || tokens[<span class="hljs-number">0</span>] !== <span class="hljs-string">'}'</span>)) {
      key = tokens.shift();
      consumeOp(tokens, <span class="hljs-string">':'</span>);
      result[key] = consumeElement(tokens);
      maybeConsumeOp(tokens, <span class="hljs-string">','</span>);
    }
    <span class="hljs-keyword">if</span> (hasDelimiters) {
      consumeOp(tokens, <span class="hljs-string">'}'</span>);
    }
    <span class="hljs-keyword">return</span> result;
  }
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">consumeElement</span><span class="hljs-params">(tokens)</span>{</span>
    <span class="hljs-keyword">switch</span> (tokens[<span class="hljs-number">0</span>]) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'['</span>:
      <span class="hljs-keyword">return</span> consumeArray(tokens, <span class="hljs-literal">true</span>);
    <span class="hljs-keyword">case</span> <span class="hljs-string">'('</span>:
      <span class="hljs-keyword">return</span> consumeTuple(tokens, <span class="hljs-literal">true</span>);
    <span class="hljs-keyword">case</span> <span class="hljs-string">'{'</span>:
      <span class="hljs-keyword">return</span> consumeFields(tokens, <span class="hljs-literal">true</span>);
    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">return</span> tokens.shift();
    }
  }
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">consumeTopLevel</span><span class="hljs-params">(tokens, types)</span>{</span>
    <span class="hljs-keyword">var</span> structure, origTokens, result;
    structure = types[<span class="hljs-number">0</span>].structure;
    <span class="hljs-keyword">if</span> (types.length === <span class="hljs-number">1</span> &amp;&amp; structure) {
      origTokens = tokens.slice();
      result = structure === <span class="hljs-string">'array'</span>
        ? consumeArray(tokens, tokens[<span class="hljs-number">0</span>] === <span class="hljs-string">'['</span>)
        : structure === <span class="hljs-string">'tuple'</span>
          ? consumeTuple(tokens, tokens[<span class="hljs-number">0</span>] === <span class="hljs-string">'('</span>)
          : consumeFields(tokens, tokens[<span class="hljs-number">0</span>] === <span class="hljs-string">'{'</span>);
      <span class="hljs-keyword">if</span> (tokens.length) {
        <span class="hljs-keyword">return</span> consumeElement(structure === <span class="hljs-string">'array'</span>
          ? [<span class="hljs-string">'['</span>].concat(origTokens, [<span class="hljs-string">']'</span>])
          : [<span class="hljs-string">'('</span>].concat(origTokens, [<span class="hljs-string">')'</span>]));
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> result;
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> consumeElement(tokens);
    }
  }
  tokenRegex = <span class="hljs-regexp">/("(?:[^"]|\\")*")|('(?:[^']|\\')*')|(#.*#)|(\/(?:\\\/|[^\/])*\/[gimy]*)|([\[\]\(\)}{:,])|([-\.\$\w]+)|\s*/</span>;
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">coerce</span><span class="hljs-params">(types, string)</span>{</span>
    <span class="hljs-keyword">var</span> tokens, node;
    tokens = reject(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(it)</span>{</span>
      <span class="hljs-keyword">return</span> !it || <span class="hljs-regexp">/^\s+$/</span>.test(it);
    }, string.split(tokenRegex));
    node = consumeTopLevel(tokens, types);
    <span class="hljs-keyword">if</span> (!node) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Error parsing "</span> + string);
    }
    <span class="hljs-keyword">return</span> coerceTypes(node, types);
  }
  module.exports = coerce;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>function log
  console.log it; it</p></div></div><div class="code"><div class="wrapper">}).call(<span class="hljs-keyword">this</span>);</div></div></div></div></body></html>