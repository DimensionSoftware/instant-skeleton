<!DOCTYPE html><html lang="en"><head><title>node_modules/LiveScript/lib/command</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../../"><meta name="groc-document-path" content="node_modules/LiveScript/lib/command"><meta name="groc-project-path" content="node_modules/LiveScript/lib/command.js"><meta name="groc-github-url" content="https://github.com/DimensionSoftware/instant-skeleton"><link rel="stylesheet" type="text/css" media="all" href="../../../assets/style.css"><script type="text/javascript" src="../../../assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/DimensionSoftware/instant-skeleton/blob/master/node_modules/LiveScript/lib/command.js">node_modules/LiveScript/lib/command.js</a></div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><p>Generated by LiveScript 1.3.0</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">var</span> LiveScript, path, fs, util, prelude, each, breakList, ref$, parseOptions, generateHelp, version, say, warn, die, p, pp, ppp, o, positional, e, slice$ = [].slice;
LiveScript = <span class="hljs-built_in">require</span>(<span class="hljs-string">'..'</span>);
path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
util = <span class="hljs-built_in">require</span>(<span class="hljs-string">'util'</span>);
prelude = <span class="hljs-built_in">require</span>(<span class="hljs-string">'prelude-ls'</span>), each = prelude.each, breakList = prelude.breakList;
ref$ = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./options'</span>), parseOptions = ref$.parse, generateHelp = ref$.generateHelp;
version = LiveScript.VERSION;
say = console.log;
warn = console.error;
die = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(message)</span>{</span>
  console.error(message);
  process.exit(<span class="hljs-number">1</span>);
};
p = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
  <span class="hljs-keyword">var</span> args;
  args = slice$.call(<span class="hljs-built_in">arguments</span>);
  each(console.dir, args);
};
pp = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(x, showHidden, depth)</span>{</span>
  say(util.inspect(x, showHidden, depth, !process.env.NODE_DISABLE_COLORS));
};
ppp = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(it)</span>{</span>
  pp(it, <span class="hljs-literal">true</span>, <span class="hljs-literal">null</span>);
};
<span class="hljs-keyword">try</span> {
  o = parseOptions(process.argv);
  positional = o._;
} <span class="hljs-keyword">catch</span> (e$) {
  e = e$;
  console.error(e.message);
  process.exit(<span class="hljs-number">1</span>);
}
<span class="hljs-keyword">switch</span> (<span class="hljs-literal">false</span>) {
<span class="hljs-keyword">case</span> !o.nodejs:
  forkNode();
  <span class="hljs-keyword">break</span>;
<span class="hljs-keyword">case</span> !o.version:
  say(<span class="hljs-string">"LiveScript version "</span> + version);
  <span class="hljs-keyword">break</span>;
<span class="hljs-keyword">case</span> !o.help:
  say(generateHelp({
    interpolate: {
      version: version
    }
  }));
  <span class="hljs-keyword">break</span>;
<span class="hljs-keyword">default</span>:
  o.run = !(o.compile || (o.compile = o.output));
  <span class="hljs-keyword">switch</span> (<span class="hljs-literal">false</span>) {
  <span class="hljs-keyword">case</span> !o.eval:
    compileScript(<span class="hljs-string">''</span>, o.eval);
    <span class="hljs-keyword">break</span>;
  <span class="hljs-keyword">case</span> !o.stdin:
    compileStdin();
    <span class="hljs-keyword">break</span>;
  <span class="hljs-keyword">case</span> !positional.length:
    compileScripts();
    <span class="hljs-keyword">break</span>;
  <span class="hljs-keyword">case</span> !<span class="hljs-built_in">require</span>(<span class="hljs-string">'tty'</span>).isatty(<span class="hljs-number">0</span>):
    say(<span class="hljs-string">"LiveScript "</span> + version + <span class="hljs-string">" - use 'lsc --help' for more information"</span>);
    repl();
    <span class="hljs-keyword">break</span>;
  <span class="hljs-keyword">default</span>:
    compileStdin();
  }
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fshoot</span><span class="hljs-params">(name, arg, callback)</span>{</span>
  fs[name](arg, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e, result)</span>{</span>
    <span class="hljs-keyword">if</span> (e) {
      die(e.stack || e);
    }
    callback(result);
  });
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compileScripts</span><span class="hljs-params">()</span>{</span>
  positional.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(it)</span>{</span>
    walk(it, path.normalize(it), <span class="hljs-literal">true</span>);
  });
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">walk</span><span class="hljs-params">(source, base, top)</span>{</span>
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">work</span><span class="hljs-params">()</span>{</span>
      fshoot(<span class="hljs-string">'readFile'</span>, source, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(it)</span>{</span>
        compileScript(source, it + <span class="hljs-string">""</span>, base);
      });
    }
    fs.stat(source, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e, stats)</span>{</span>
      <span class="hljs-keyword">if</span> (e) {
        <span class="hljs-keyword">if</span> (!top || <span class="hljs-regexp">/(?:\.ls|\/)$/</span>.test(source)) {
          die(<span class="hljs-string">"Can't find: "</span> + source);
        }
        walk(source + <span class="hljs-string">".ls"</span>, base);
        <span class="hljs-keyword">return</span>;
      }
      <span class="hljs-keyword">if</span> (stats.isDirectory()) {
        <span class="hljs-keyword">if</span> (!o.run) {
          fshoot(<span class="hljs-string">'readdir'</span>, source, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(it)</span>{</span>
            it.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(it)</span>{</span>
              walk(source + <span class="hljs-string">"/"</span> + it, base);
            });
          });
          <span class="hljs-keyword">return</span>;
        }
        source += <span class="hljs-string">'/index.ls'</span>;
      }
      <span class="hljs-keyword">if</span> (top || <span class="hljs-string">'.ls'</span> === source.slice(-<span class="hljs-number">3</span>)) {
        <span class="hljs-keyword">if</span> (o.watch) {
          watch(source, work);
        } <span class="hljs-keyword">else</span> {
          work();
        }
      }
    });
  }
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compileScript</span><span class="hljs-params">(filename, input, base)</span>{</span>
  <span class="hljs-keyword">var</span> options, t, json, e;
  options = {
    filename: filename,
    bare: o.bare,
    <span class="hljs-string">'const'</span>: o[<span class="hljs-string">'const'</span>]
  };
  t = {
    input: input,
    options: options
  };
  <span class="hljs-keyword">try</span> {
    LiveScript.emit(<span class="hljs-string">'lex'</span>, t);
    t.tokens = LiveScript.tokens(t.input, {
      raw: o.lex
    });
    <span class="hljs-keyword">if</span> (o.lex || o.tokens) {
      printTokens(t.tokens);
      <span class="hljs-keyword">throw</span> <span class="hljs-literal">null</span>;
    }
    LiveScript.emit(<span class="hljs-string">'parse'</span>, t);
    t.ast = LiveScript.ast(t.tokens);
    json = o.json || <span class="hljs-regexp">/\.json\.ls$/</span>.test(filename);
    <span class="hljs-keyword">if</span> (o.ast) {
      say(json
        ? t.ast.stringify(<span class="hljs-number">2</span>)
        : <span class="hljs-string">''</span>.trim.call(t.ast));
      <span class="hljs-keyword">throw</span> <span class="hljs-literal">null</span>;
    }
    LiveScript.emit(<span class="hljs-string">'compile'</span>, t);
    options.bare || (options.bare = json || o.run);
    <span class="hljs-keyword">if</span> (json || o.run &amp;&amp; o.print) {
      t.ast.makeReturn();
    }
    t.output = t.ast.compileRoot(options);
    <span class="hljs-keyword">if</span> (o.compile &amp;&amp; o.header) {
      t.output = <span class="hljs-string">"// Generated by LiveScript "</span> + version + <span class="hljs-string">"\n"</span> + t.output;
    }
    <span class="hljs-keyword">if</span> (json || o.run) {
      LiveScript.emit(<span class="hljs-string">'run'</span>, t);
      t.result = LiveScript.run(t.output, options, <span class="hljs-literal">true</span>);
    }
    <span class="hljs-keyword">if</span> (json) {
      t.output = <span class="hljs-built_in">JSON</span>.stringify(t.result, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>) + <span class="hljs-string">'\n'</span>;
    }
    <span class="hljs-keyword">if</span> (o.run) {
      <span class="hljs-keyword">switch</span> (<span class="hljs-literal">false</span>) {
      <span class="hljs-keyword">case</span> !json:
        process.stdout.write(t.output);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> !o.print:
        console.log(t.result);
      }
      <span class="hljs-keyword">throw</span> <span class="hljs-literal">null</span>;
    }
    LiveScript.emit(<span class="hljs-string">'write'</span>, t);
    <span class="hljs-keyword">if</span> (o.print || !filename) {
      say(t.output.trimRight());
    } <span class="hljs-keyword">else</span> {
      writeJS(filename, t.output, base, json);
    }
  } <span class="hljs-keyword">catch</span> (e$) {
    e = e$;
    <span class="hljs-keyword">if</span> (e != <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">if</span> (LiveScript.listeners(<span class="hljs-string">'failure'</span>).length) {
        LiveScript.emit(<span class="hljs-string">'failure'</span>, e, t);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (filename) {
          warn(<span class="hljs-string">"Failed at: "</span> + filename);
        }
        <span class="hljs-keyword">if</span> (!(e <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">SyntaxError</span> || <span class="hljs-regexp">/^Parse error /</span>.test(e.message))) {
          e = e.stack || e;
        }
        <span class="hljs-keyword">if</span> (o.watch) {
          warn(e + <span class="hljs-string">'\x07'</span>);
        } <span class="hljs-keyword">else</span> {
          die(e);
        }
      }
      <span class="hljs-keyword">return</span>;
    }
  }
  LiveScript.emit(<span class="hljs-string">'success'</span>, t);
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compileStdin</span><span class="hljs-params">()</span>{</span>
  <span class="hljs-keyword">var</span> x$, code;
  x$ = process.openStdin();
  code = <span class="hljs-string">''</span>;
  x$.on(<span class="hljs-string">'data'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(it)</span>{</span>
    code += it;
  });
  x$.on(<span class="hljs-string">'end'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
    compileScript(<span class="hljs-string">''</span>, code);
  });
  x$.on(<span class="hljs-string">'data'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
    <span class="hljs-keyword">var</span> ref$;
    <span class="hljs-keyword">if</span> ((ref$ = code.slice(-<span class="hljs-number">3</span>)) === <span class="hljs-string">'\x04\r\n'</span> || ref$ === <span class="hljs-string">'\x1a\r\n'</span>) {
      compileScript(<span class="hljs-string">''</span>, code.slice(<span class="hljs-number">0</span>, -<span class="hljs-number">3</span>));
      x$.destroy();
    }
  });
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">watch</span><span class="hljs-params">(source, action)</span>{</span>
  (<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">repeat</span><span class="hljs-params">(ptime)</span>{</span>
    fshoot(<span class="hljs-string">'stat'</span>, source, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(arg$)</span>{</span>
      <span class="hljs-keyword">var</span> mtime;
      mtime = arg$.mtime;
      <span class="hljs-keyword">if</span> (ptime ^ mtime) {
        action();
      }
      setTimeout(repeat, <span class="hljs-number">500</span>, mtime);
    });
  }.call(<span class="hljs-keyword">this</span>, <span class="hljs-number">0</span>));
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeJS</span><span class="hljs-params">(source, js, base, json)</span>{</span>
  <span class="hljs-keyword">var</span> filename, dir, that, jsPath;
  filename = path.basename(source).replace(<span class="hljs-regexp">/(?:(\.\w+)?\.\w+)?$/</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>] || (json ? <span class="hljs-string">'.json'</span> : <span class="hljs-string">'.js'</span>);
  });
  dir = path.dirname(source);
  <span class="hljs-keyword">if</span> (that = o.output) {
    dir = path.join(that, dir.slice(base === <span class="hljs-string">'.'</span>
      ? <span class="hljs-number">0</span>
      : base.length));
  }
  jsPath = path.join(dir, filename);
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compile</span><span class="hljs-params">()</span>{</span>
    fs.writeFile(jsPath, js || <span class="hljs-string">'\n'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span>{</span>
      <span class="hljs-keyword">if</span> (e) {
        <span class="hljs-keyword">return</span> warn(e);
      }
      <span class="hljs-keyword">if</span> (o.watch) {
        util.log(source + <span class="hljs-string">" =&gt; "</span> + jsPath);
      }
    });
  }
  fs.stat(dir, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span>{</span>
    <span class="hljs-keyword">if</span> (!e) {
      <span class="hljs-keyword">return</span> compile();
    }
    <span class="hljs-built_in">require</span>(<span class="hljs-string">'child_process'</span>).exec(<span class="hljs-string">"mkdir "</span> + [!<span class="hljs-regexp">/^win/</span>.test(process.platform) ? <span class="hljs-string">'-p'</span> : <span class="hljs-keyword">void</span> <span class="hljs-number">8</span>] + <span class="hljs-string">" "</span> + dir, compile);
  });
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">printTokens</span><span class="hljs-params">(tokens)</span>{</span>
  <span class="hljs-keyword">var</span> lines, i$, len$, ref$, tag, val, lno, l;
  lines = [];
  <span class="hljs-keyword">for</span> (i$ = <span class="hljs-number">0</span>, len$ = tokens.length; i$ &lt; len$; ++i$) {
    ref$ = tokens[i$], tag = ref$[<span class="hljs-number">0</span>], val = ref$[<span class="hljs-number">1</span>], lno = ref$[<span class="hljs-number">2</span>];
    ((ref$ = lines[lno]) != <span class="hljs-literal">null</span>
      ? ref$
      : lines[lno] = []).push(tag.toLowerCase() === val
      ? tag
      : tag + <span class="hljs-string">":"</span> + val);
  }
  <span class="hljs-keyword">for</span> (i$ = <span class="hljs-number">0</span>, len$ = lines.length; i$ &lt; len$; ++i$) {
    l = lines[i$];
    say(l ? l.join(<span class="hljs-string">' '</span>).replace(<span class="hljs-regexp">/\n/g</span>, <span class="hljs-string">'\\n'</span>) : <span class="hljs-string">''</span>);
  }
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">repl</span><span class="hljs-params">()</span>{</span>
  <span class="hljs-keyword">var</span> code, cont, rl, reset, _ttyWrite, prompt, that, vm, replCtx, server, ref$;
  code = repl.infunc ? <span class="hljs-string">'  '</span> : <span class="hljs-string">''</span>;
  cont = <span class="hljs-number">0</span>;
  rl = <span class="hljs-built_in">require</span>(<span class="hljs-string">'readline'</span>).createInterface(process.stdin, process.stdout);
  reset = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
    rl.line = code = <span class="hljs-string">''</span>;
    rl.prompt();
    repl.inheredoc = <span class="hljs-literal">false</span>;
  };
  (_ttyWrite = rl._ttyWrite, rl)._ttyWrite = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(char)</span>{</span>
    <span class="hljs-keyword">if</span> (char === <span class="hljs-string">'\n'</span> || char === <span class="hljs-string">'&gt;'</span>) {
      cont += <span class="hljs-number">1</span>;
    } <span class="hljs-keyword">else</span> {
      cont = <span class="hljs-number">0</span>;
    }
    <span class="hljs-keyword">return</span> _ttyWrite.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
  };
  prompt = <span class="hljs-string">'ls'</span>;
  <span class="hljs-keyword">if</span> (that = repeatString$(<span class="hljs-string">'b'</span>, !!o.bare) + repeatString$(<span class="hljs-string">'c'</span>, !!o.compile)) {
    prompt += <span class="hljs-string">" -"</span> + that;
  }
  <span class="hljs-keyword">if</span> (LiveScript != <span class="hljs-literal">null</span>) {
    LiveScript.history = rl.history;
  }
  <span class="hljs-keyword">if</span> (!o.compile) {
    module.paths = module.constructor._nodeModulePaths(module.filename = process.cwd() + <span class="hljs-string">'/repl'</span>);
    vm = <span class="hljs-built_in">require</span>(<span class="hljs-string">'vm'</span>);
    <span class="hljs-keyword">if</span> (o.prelude) {
      import$(global, prelude);
    }
    replCtx = {};
    import$(replCtx, global);
    replCtx.module = module;
    replCtx.exports = exports;
    replCtx.require = <span class="hljs-built_in">require</span>;
    replCtx.LiveScript = LiveScript;
    replCtx.path = path;
    replCtx.fs = fs;
    replCtx.util = util;
    replCtx.say = say;
    replCtx.warn = warn;
    replCtx.die = die;
    replCtx.p = p;
    replCtx.pp = pp;
    replCtx.ppp = ppp;
    server = (ref$ = clone$(<span class="hljs-built_in">require</span>(<span class="hljs-string">'repl'</span>).REPLServer.prototype), ref$.context = replCtx, ref$.commands = [], ref$.useGlobal = <span class="hljs-literal">false</span>, ref$.useColors = process.env.NODE_DISABLE_COLORS, ref$.<span class="hljs-built_in">eval</span> = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(code, ctx, arg$, cb)</span>{</span>
      <span class="hljs-keyword">var</span> res, e;
      <span class="hljs-keyword">try</span> {
        res = vm.runInNewContext(code, ctx, <span class="hljs-string">'repl'</span>);
      } <span class="hljs-keyword">catch</span> (e$) {
        e = e$;
      }
      cb(e, res);
    }, ref$);
    rl.completer = bind$(server, <span class="hljs-string">'complete'</span>);
  }
  rl.on(<span class="hljs-string">'SIGCONT'</span>, rl.prompt);
  rl.on(<span class="hljs-string">'SIGINT'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.line || code) {
      say(<span class="hljs-string">''</span>);
      reset();
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">this</span>.close();
    }
  });
  rl.on(<span class="hljs-string">'close'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
    say(<span class="hljs-string">''</span>);
    <span class="hljs-keyword">return</span> process.exit();
  });
  rl.on(<span class="hljs-string">'line'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(it)</span>{</span>
    <span class="hljs-keyword">var</span> isheredoc, ops, x, e;
    <span class="hljs-keyword">if</span> (it.match(<span class="hljs-regexp">/^$/</span>)) {
      repl.infunc = <span class="hljs-literal">false</span>;
    }
    <span class="hljs-keyword">if</span> (it.match(<span class="hljs-regexp">/(\=|\~&gt;|-&gt;|do|import|switch)\s*$/</span>) || (it.match(<span class="hljs-regexp">/^!?(function|class|if|unless) /</span>) &amp;&amp; !it.match(<span class="hljs-regexp">/ then /</span>))) {
      repl.infunc = <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">if</span> (((<span class="hljs-number">0</span> &lt; cont &amp;&amp; cont &lt; <span class="hljs-number">3</span>) || repl.infunc) &amp;&amp; !repl.inheredoc) {
      code += it + <span class="hljs-string">'\n'</span>;
      <span class="hljs-keyword">this</span>.output.write(repeatString$(<span class="hljs-string">'.'</span>, prompt.length) + <span class="hljs-string">'. '</span>);
      <span class="hljs-keyword">return</span>;
    } <span class="hljs-keyword">else</span> {
      isheredoc = it.match(<span class="hljs-regexp">/(\'\'\'|\"\"\")/g</span>);
      <span class="hljs-keyword">if</span> (isheredoc &amp;&amp; isheredoc.length % <span class="hljs-number">2</span> === <span class="hljs-number">1</span>) {
        repl.inheredoc = !repl.inheredoc;
      }
      <span class="hljs-keyword">if</span> (repl.inheredoc) {
        code += it + <span class="hljs-string">'\n'</span>;
        rl.output.write(repeatString$(<span class="hljs-string">'.'</span>, prompt.length) + <span class="hljs-string">'" '</span>);
        <span class="hljs-keyword">return</span>;
      }
    }
    repl.inheredoc = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (!(code += it)) {
      <span class="hljs-keyword">return</span> reset();
    }
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">if</span> (o.compile) {
        say(LiveScript.compile(code, {
          bare: o.bare
        }));
      } <span class="hljs-keyword">else</span> {
        ops = {
          <span class="hljs-string">'eval'</span>: <span class="hljs-string">'eval'</span>,
          bare: <span class="hljs-literal">true</span>,
          saveScope: LiveScript
        };
        <span class="hljs-keyword">if</span> (code.match(<span class="hljs-regexp">/^\s*!?function/</span>)) {
          ops = {
            bare: <span class="hljs-literal">true</span>
          };
        }
        x = vm.runInNewContext(LiveScript.compile(code, ops), replCtx, <span class="hljs-string">'repl'</span>);
        <span class="hljs-keyword">if</span> (x != <span class="hljs-literal">null</span>) {
          replCtx._ = x;
        }
        pp(x);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> x === <span class="hljs-string">'function'</span>) {
          say(x);
        }
      }
    } <span class="hljs-keyword">catch</span> (e$) {
      e = e$;
      say(e);
    }
    reset();
  });
  process.on(<span class="hljs-string">'uncaughtException'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(it)</span>{</span>
    say(<span class="hljs-string">"\n"</span> + ((it != <span class="hljs-literal">null</span> ? it.stack : <span class="hljs-keyword">void</span> <span class="hljs-number">8</span>) || it));
  });
  process.on(<span class="hljs-string">'exit'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
    <span class="hljs-keyword">if</span> (code &amp;&amp; rl.output.isTTY) {
      rl._ttyWrite(<span class="hljs-string">'\r'</span>);
    }
  });
  rl.setPrompt(prompt + <span class="hljs-string">"&gt; "</span>);
  rl.prompt();
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">forkNode</span><span class="hljs-params">()</span>{</span>
  <span class="hljs-keyword">var</span> ref$, args, lsArgs, ref1$, nodeArgs;
  ref$ = process.argv, args = slice$.call(ref$, <span class="hljs-number">1</span>);
  ref$ = breakList((<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(it)</span>{</span>
    <span class="hljs-keyword">return</span> it === <span class="hljs-string">'--nodejs'</span> || it === <span class="hljs-string">'-n'</span>;
  }), args), lsArgs = ref$[<span class="hljs-number">0</span>], ref1$ = ref$[<span class="hljs-number">1</span>], nodeArgs = slice$.call(ref1$, <span class="hljs-number">1</span>);
  <span class="hljs-built_in">require</span>(<span class="hljs-string">'child_process'</span>).spawn(process.execPath, nodeArgs.concat(lsArgs), {
    cwd: process.cwd(),
    customFds: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
  });
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">repeatString$</span><span class="hljs-params">(str, n)</span>{</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> r = <span class="hljs-string">''</span>; n &gt; <span class="hljs-number">0</span>; (n &gt;&gt;= <span class="hljs-number">1</span>) &amp;&amp; (str += str)) <span class="hljs-keyword">if</span> (n &amp; <span class="hljs-number">1</span>) r += str;
  <span class="hljs-keyword">return</span> r;
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">import$</span><span class="hljs-params">(obj, src)</span>{</span>
  <span class="hljs-keyword">var</span> own = {}.hasOwnProperty;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> src) <span class="hljs-keyword">if</span> (own.call(src, key)) obj[key] = src[key];
  <span class="hljs-keyword">return</span> obj;
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clone$</span><span class="hljs-params">(it)</span>{</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fun</span><span class="hljs-params">()</span>{</span>} fun.prototype = it;
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> fun;
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bind$</span><span class="hljs-params">(obj, key, target)</span>{</span>
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span> <span class="hljs-keyword">return</span> (target || obj)[key].apply(obj, <span class="hljs-built_in">arguments</span>) };
}</div></div></div></div></body></html>